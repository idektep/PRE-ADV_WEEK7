#include <Arduino.h>
#include "AGV.h"

#define MR_IN1 12 //motor1
#define MR_IN2 13 //motor1
#define MR_IN3 32 //motor2
#define MR_IN4 33 //motor2

#define ML_IN1 27 //motor4
#define ML_IN2 14 //motor4
#define ML_IN3 25 //motor3
#define ML_IN4 26 //motor3

#define R_ENA 15  //Adjust speed  //motor1
#define R_ENB 2   //Adjust speed //motor2
#define L_ENA 19  //Adjust speed //motor4
#define L_ENB 4   //Adjust speed //motor3

#define LED_R 17
#define LED_L 16

void AGV::pinsetup(){
  pinMode(LED_R, OUTPUT);
  pinMode(LED_L, OUTPUT);
  pinMode(MR_IN1, OUTPUT);
  pinMode(MR_IN2, OUTPUT);
  pinMode(MR_IN3, OUTPUT);
  pinMode(MR_IN4, OUTPUT);
  pinMode(ML_IN1, OUTPUT);
  pinMode(ML_IN2, OUTPUT);
  pinMode(ML_IN3, OUTPUT);
  pinMode(ML_IN4, OUTPUT);
  pinMode(L_ENA, OUTPUT);
  pinMode(L_ENB, OUTPUT);
  pinMode(R_ENA, OUTPUT);
  pinMode(R_ENB, OUTPUT);
}
void AGV::forward(int d){
  digitalWrite(LED_R, HIGH);
  digitalWrite(LED_L, HIGH);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, HIGH);  //motor1
  digitalWrite(MR_IN2, LOW);   //motor1
  digitalWrite(MR_IN3, HIGH);  //motor2
  digitalWrite(MR_IN4, LOW);   //motor2

  digitalWrite(ML_IN3, HIGH);  //motor3
  digitalWrite(ML_IN4, LOW);   //motor3
  digitalWrite(ML_IN1, HIGH);  //motor4
  digitalWrite(ML_IN2, LOW);   //motor4
  delay(d);
}
void AGV::backward(int d){
  digitalWrite(LED_R, HIGH);
  digitalWrite(LED_L, HIGH);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, LOW);
  digitalWrite(MR_IN2, HIGH);
  digitalWrite(MR_IN3, LOW);
  digitalWrite(MR_IN4, HIGH);
  
  digitalWrite(ML_IN1, LOW);
  digitalWrite(ML_IN2, HIGH);
  digitalWrite(ML_IN3, LOW);
  digitalWrite(ML_IN4, HIGH);
  delay(d);
}
void AGV::turnleft(int d){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 1);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, HIGH);
  digitalWrite(MR_IN2, LOW);
  digitalWrite(MR_IN3, HIGH);
  digitalWrite(MR_IN4, LOW);

  digitalWrite(ML_IN1, LOW);
  digitalWrite(ML_IN2, HIGH);
  digitalWrite(ML_IN3, LOW);
  digitalWrite(ML_IN4, HIGH);
  delay(d);
}
void AGV::turnright(int d){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 1);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, LOW);
  digitalWrite(MR_IN2, HIGH);
  digitalWrite(MR_IN3, LOW);
  digitalWrite(MR_IN4, HIGH);
  
  digitalWrite(ML_IN1, HIGH);
  digitalWrite(ML_IN2, LOW);
  digitalWrite(ML_IN3, HIGH);
  digitalWrite(ML_IN4, LOW);
  delay(d);
}
void AGV::slideleft(int d){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 1);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, LOW);
  digitalWrite(MR_IN2, HIGH);
  digitalWrite(MR_IN3, HIGH);
  digitalWrite(MR_IN4, LOW);

  digitalWrite(ML_IN1, LOW);
  digitalWrite(ML_IN2, HIGH);
  digitalWrite(ML_IN3, HIGH);
  digitalWrite(ML_IN4, LOW);
  delay(d);
}
void AGV::slideright(int d){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 0);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, HIGH);
  digitalWrite(MR_IN2, LOW);
  digitalWrite(MR_IN3, LOW);
  digitalWrite(MR_IN4, HIGH);

  digitalWrite(ML_IN1, HIGH);
  digitalWrite(ML_IN2, LOW);
  digitalWrite(ML_IN3, LOW);
  digitalWrite(ML_IN4, HIGH);
  delay(d);
}
void AGV::slideleftfront(int d){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 0);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, LOW);
  digitalWrite(MR_IN2, LOW);
  digitalWrite(MR_IN3, HIGH);
  digitalWrite(MR_IN4, LOW);

  digitalWrite(ML_IN1, LOW);
  digitalWrite(ML_IN2, LOW);
  digitalWrite(ML_IN3, HIGH);
  digitalWrite(ML_IN4, LOW);
  delay(d);
}
void AGV::slideleftback(int d){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 0);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, LOW);
  digitalWrite(MR_IN2, HIGH);
  digitalWrite(MR_IN3, LOW);
  digitalWrite(MR_IN4, LOW);

  digitalWrite(ML_IN1, LOW);
  digitalWrite(ML_IN2, HIGH);
  digitalWrite(ML_IN3, LOW);
  digitalWrite(ML_IN4, LOW);
  delay(d);
}
void AGV::sliderightfront(int d){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 0);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);
  digitalWrite(MR_IN1, HIGH);
  digitalWrite(MR_IN2, LOW);
  digitalWrite(MR_IN3, LOW);
  digitalWrite(MR_IN4, LOW);

  digitalWrite(ML_IN1, HIGH);
  digitalWrite(ML_IN2, LOW);
  digitalWrite(ML_IN3, LOW);
  digitalWrite(ML_IN4, LOW);
  delay(d);
}
void AGV::sliderightback(int d){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 0);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, LOW);
  digitalWrite(MR_IN2, LOW);
  digitalWrite(MR_IN3, LOW);
  digitalWrite(MR_IN4, HIGH);

  digitalWrite(ML_IN1, LOW);
  digitalWrite(ML_IN2, LOW);
  digitalWrite(ML_IN3, LOW);
  digitalWrite(ML_IN4, HIGH);
  delay(d);
}

void AGV::stop(){
  digitalWrite(LED_R, 0);
  digitalWrite(LED_L, 0);
  analogWrite(L_ENA, 200); //130-255
  analogWrite(L_ENB, 200);
  analogWrite(R_ENA, 200);
  analogWrite(R_ENB, 200);

  digitalWrite(MR_IN1, 0);  //motor1
  digitalWrite(MR_IN2, 0);   //motor1
  digitalWrite(MR_IN3, 0);  //motor2
  digitalWrite(MR_IN4, 0);   //motor2

  digitalWrite(ML_IN3, 0);  //motor3
  digitalWrite(ML_IN4, 0);   //motor3
  digitalWrite(ML_IN1, 0);  //motor4
  digitalWrite(ML_IN2, 0);   //motor4
  delay(100);
}
